(function(t){function e(e){for(var a,i,r=e[0],c=e[1],l=e[2],d=0,m=[];d<r.length;d++)i=r[d],o[i]&&m.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);u&&u(e);while(m.length)m.shift()();return s.push.apply(s,l||[]),n()}function n(){for(var t,e=0;e<s.length;e++){for(var n=s[e],a=!0,r=1;r<n.length;r++){var c=n[r];0!==o[c]&&(a=!1)}a&&(s.splice(e--,1),t=i(i.s=n[0]))}return t}var a={},o={sales:0},s=[];function i(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=a,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(n,a,function(e){return t[e]}.bind(null,a));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],c=r.push.bind(r);r.push=e,r=r.slice();for(var l=0;l<r.length;l++)e(r[l]);var u=c;s.push([1,"chunk-vendors","chunk-common"]),n()})({1:function(t,e,n){t.exports=n("c677")},1315:function(t,e,n){"use strict";var a=n("de36"),o=n.n(a);o.a},"4eb4":function(t,e,n){},8447:function(t,e,n){"use strict";var a=n("4eb4"),o=n.n(a);o.a},aadb:function(t,e,n){},c0c8:function(t,e,n){"use strict";var a=n("d5e1"),o=n.n(a);o.a},c677:function(t,e,n){"use strict";n.r(e);n("cadf"),n("551c"),n("f751"),n("097d");var a=n("2b0e"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[n("router-view")],1)],1)},s=[],i={name:"Sales"},r=i,c=(n("1315"),n("e56b"),n("2877")),l=Object(c["a"])(r,o,s,!1,null,"06117b68",null),u=l.exports,d=n("2f62"),m=(n("96cf"),n("3b8d")),p=n("bc3a"),h=n.n(p),g={token:{},loggedIn:!1},f={getToken:function(t){return t.token},getLoggedIn:function(t){return t.loggedIn}},v={fetchToken:function(){var t=Object(m["a"])(regeneratorRuntime.mark(function t(e,n){var a,o,s;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return a=e.commit,o={user:n.user,password:n.password},t.next=4,h.a.post("/api/salesAuth",{headers:{"Content-type":"application/json"},body:JSON.stringify(o)});case 4:s=t.sent,a("setToken",s.data.token),a("setLoggedIn",!0);case 7:case"end":return t.stop()}},t)}));function e(e,n){return t.apply(this,arguments)}return e}()},b={setToken:function(t,e){return t.token=e},setLoggedIn:function(t,e){return t.loggedIn=e}},w={state:g,getters:f,actions:v,mutations:b},_=(n("ac6a"),n("456d"),{list:{hot:[],warm:[],cold:[],unknown:[],inProgress:[],done:[]},config:{},products:{},pictograms:{}}),y={getList:function(t){return t.list},getConfig:function(t){return t.config},getProducts:function(t){return t.products},getPictograms:function(t){return t.pictograms}},k={fetchConfig:function(){var t=Object(m["a"])(regeneratorRuntime.mark(function t(e){var n,a,o,s,i,r,c;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,a=sessionStorage.getItem("token"),o="Bearer "+a,t.prev=3,t.next=6,h.a.get("/api/salesConfig",{headers:{"Content-type":"application/x-www-form-urlencoded",Authorization:o}});case 6:s=t.sent,i=s.data.productNames,r=s.data.salesConfig,c=s.data.pictograms,n("setProducts",i),n("setConfig",r),n("setPictograms",c),t.next=18;break;case 15:t.prev=15,t.t0=t["catch"](3),console.log("Error: ",t.t0);case 18:case"end":return t.stop()}},t,null,[[3,15]])}));function e(e){return t.apply(this,arguments)}return e}(),fetchList:function(){var t=Object(m["a"])(regeneratorRuntime.mark(function t(e){var n,a,o,s,i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return n=e.commit,a=sessionStorage.getItem("token"),o="Bearer "+a,t.prev=3,t.next=6,h.a.get("/api/salesList",{headers:{"Content-type":"application/x-www-form-urlencoded",Authorization:o}});case 6:s=t.sent,i=s.data,n("setLists",i),t.next=14;break;case 11:t.prev=11,t.t0=t["catch"](3),console.log("Error: ",t.t0);case 14:case"end":return t.stop()}},t,null,[[3,11]])}));function e(e){return t.apply(this,arguments)}return e}()},C={setConfig:function(t,e){return t.config=e},setLists:function(t,e){return t.list=e},setList:function(t,e){return t.list[Object.keys(e)[0]]=e[Object.keys(e)[0]]},setProducts:function(t,e){return t.products=e},setPictograms:function(t,e){return t.pictograms=e}},V={state:_,getters:y,actions:k,mutations:C},x={visitor:{},unchangedVisitor:{}},O={getVisitor:function(t){return t.visitor},getUnchangedVisitor:function(t){return t.unchangedVisitor}},j={changeStatus:function(){var t=Object(m["a"])(regeneratorRuntime.mark(function t(e,n){var a,o;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return e.commit,a=sessionStorage.getItem("token"),o="Bearer "+a,t.prev=3,t.next=6,h.a.get("/api/salesStatus",{headers:{"Content-type":"application/x-www-form-urlencoded",Authorization:o},params:{visitor:n}});case 6:t.next=11;break;case 8:t.prev=8,t.t0=t["catch"](3),console.log("Error: ",t.t0);case 11:case"end":return t.stop()}},t,null,[[3,8]])}));function e(e,n){return t.apply(this,arguments)}return e}(),setVisitor:function(t,e){var n=t.commit;n("initVisitor",e)},updateVisitor:function(t,e){var n=t.commit;n("mutateVisitor",e)}},E={initVisitor:function(t,e){t.visitor=e,t.unchangedVisitor=e},mutateVisitor:function(t,e){return t.visitor[Object.keys(e)[0]]=e[Object.keys(e)[0]]}},L={state:x,getters:O,actions:j,mutations:E};a["a"].use(d["a"]);var T=new d["a"].Store({modules:{login:w,list:V,detail:L}}),D=n("4af9"),P=n("1881"),S=n.n(P),I=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"login"},[n("form",{attrs:{id:"salesLogin"}},[n("input",{directives:[{name:"model",rawName:"v-model",value:t.credentials.user,expression:"credentials.user"}],staticClass:"loginInput",attrs:{type:"text",placeholder:"Username"},domProps:{value:t.credentials.user},on:{input:function(e){e.target.composing||t.$set(t.credentials,"user",e.target.value)}}}),n("input",{directives:[{name:"model",rawName:"v-model",value:t.credentials.password,expression:"credentials.password"}],staticClass:"loginInput",attrs:{type:"password",placeholder:"Password"},domProps:{value:t.credentials.password},on:{input:function(e){e.target.composing||t.$set(t.credentials,"password",e.target.value)}}}),n("CustomButton",{attrs:{id:"loginButton",btnName:"Login"},on:{buttonClicked:function(e){return t.handleLogin(t.credentials)}}})],1),n("v-dialog",{attrs:{id:"errorDialog",width:300}})],1)},R=[],$=n("cebc"),F=n("fd28"),B={name:"Login",data:function(){return{credentials:{user:"",password:""}}},components:{CustomButton:F["a"]},methods:Object($["a"])({},Object(d["b"])(["fetchToken"]),{handleLogin:function(t){var e=this,n=this;this.fetchToken(t).then(function(){n.getLoggedIn&&(sessionStorage.setItem("token",e.getToken),n.$router.push({path:"/sales/list"}))}).catch(function(t){console.warn(t),e.showModal()})},showModal:function(){this.$modal.show("dialog",{title:"Wups",text:"Login nicht erfolgreich!"})}}),computed:Object($["a"])({},Object(d["c"])(["getToken","getLoggedIn"]))},M=B,A=(n("d231"),Object(c["a"])(M,I,R,!1,null,"c2665f6e",null)),N=A.exports,K=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{directives:[{name:"touch",rawName:"v-touch:swipe",value:t.swipeHandler,expression:"swipeHandler",arg:"swipe"}],attrs:{id:"listWrapper"}},[n("pull-to",{attrs:{"top-load-method":t.refresh,topConfig:t.touchReloadConfig}},[n("transition",{attrs:{name:"fade",mode:"out-in"}},[n("ul",{key:t.$route.params.tab,attrs:{id:"visitorList"}},[n("transition-group",{attrs:{name:"list-complete",tag:"ul"}},t._l(t.getList[t.tab],function(e){return n("li",{key:""+e.user_hash_id,staticClass:"listElement"},[n("div",{staticClass:"visitor",on:{click:function(n){return t.handleDetailView(e)}}},[n("div",{staticClass:"col_1"},[n("img",{staticClass:"visitorPhoto",attrs:{src:e.visitor_picture_url||"/img/icons/sales_placeholder.png"}}),n("span",{staticClass:"bubble"},[t._v(t._s(Math.trunc((new Date-(new Date).getTimezoneOffset()-Date.parse(e.time_of_registration))/1e3/60))+" min")])]),n("div",{staticClass:"col_2"},[n("p",{staticClass:"even"},[t._v(t._s(e.first_name+" "+e.last_name))]),n("p",{staticClass:"odd"},[t._v(t._s(e.company))]),n("p",{staticClass:"even"},[t._v(t._s(e.job_title))]),n("p",{staticClass:"odd"},[t._v(t._s(void 0!==t.getProducts[e.product_type-1]?t.getProducts[e.product_type-1].name:""))])])])])}),0)],1)]),n("nav",{attrs:{id:"tabs"}},[n("router-link",{staticClass:"navLink",attrs:{to:"/sales/list/hot"},on:{change:t.newVisitor},model:{value:t.getList.hot,callback:function(e){t.$set(t.getList,"hot",e)},expression:"getList.hot"}},[t._v("Hot"+t._s(t.change?"+":"")+" "+t._s(t.toleranceTime("hot")?"*":""))]),n("router-link",{staticClass:"navLink",attrs:{to:"/sales/list/warm"}},[t._v("Warm "+t._s(t.toleranceTime("warm")?"*":""))]),n("router-link",{staticClass:"navLink",attrs:{to:"/sales/list/cold"}},[t._v("Cold "+t._s(t.toleranceTime("cold")?"*":""))]),n("router-link",{staticClass:"navLink",attrs:{to:"/sales/list/unknown"}},[t._v("Unknown "+t._s(t.toleranceTime("unknown")?"*":""))]),n("router-link",{staticClass:"navLink",attrs:{to:"/sales/list/done"}},[t._v("Done")]),n("router-view",{key:t.$route.name+(t.$route.params.tab||t.tab)})],1)],1)],1)},z=[],U=(n("20d6"),n("84b4"),n("4917"),n("897d")),H=n.n(U),J={name:"List",components:{PullTo:H.a},data:function(){return{tab:sessionStorage.getItem("tab")||location.pathname.match(/^\/sales\/list\/(hot|warm|cold|unknown|done)$/)?location.pathname.match(/^\/sales\/list\/(hot|warm|cold|unknown|done)$/)[1]:"hot",tabs:["hot","warm","cold","unknown","done"],poll:"",change:!1,touchReloadConfig:{pullText:"Fetch visitors!",triggerText:"Fetching visitors!",loadingText:"Fetching..",doneText:"Visitors fetched!",failText:"Could not load Visitors!",loadedStayTime:400,stayDistance:50,triggerDistance:70}}},methods:Object($["a"])({},Object(d["b"])(["fetchList","fetchConfig","setVisitor","changeStatus"]),{handleDetailView:function(t){"done"!==t.handled_by_sales&&(t.handled_by_sales="in progress",this.changeStatus(t)),this.setVisitor(t),this.$router.push({path:"/sales/detail/"+t.user_hash_id})},toleranceTime:function(t){var e=this,n=this.getList[t].some(function(n){return!!(n&&Math.trunc((new Date-(new Date).getTimezoneOffset()-Date.parse(n.time_of_registration))/1e3/60)>e.getConfig[t]/1e3/60)});return n},newVisitor:function(){"hot"!==this.tab?this.change=!0:this.change=!1},swipeHandler:function(t){var e=this;if("right"===t&&"hot"!==this.tab){var n=this.tabs.findIndex(function(t){return t===e.tab});this.$router.push({path:"/sales/list/"+this.tabs[n-1]})}if("left"===t&&"done"!==this.tab){var a=this.tabs.findIndex(function(t){return t===e.tab});this.$router.push({path:"/sales/list/"+this.tabs[a+1]})}},refresh:function(){var t=Object(m["a"])(regeneratorRuntime.mark(function t(e){return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.fetchList();case 2:e("done");case 3:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}()}),computed:Object($["a"])({},Object(d["c"])(["getToken","getList","getConfig","getProducts"])),created:function(){var t=this;this.fetchList(),this.fetchConfig().then(function(){t.poll=setInterval(function(){t.fetchList()},t.getConfig.pollingInterval)})},beforeDestroy:function(){clearInterval(this.poll)},watch:{"$route.params.tab":function(t){this.fetchList(this.getToken),this.tab=t}}},W=J,q=(n("8447"),Object(c["a"])(W,K,z,!1,null,"1049e4a0",null)),Z=q.exports,G=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"detailWrapper"}},[n("div",{attrs:{id:"imageBubbles"}},[n("img",{attrs:{id:"visitorImage",src:t.getVisitor.visitor_picture_url||"/img/icons/sales_placeholder.png"}}),n("div",{attrs:{id:"bubbles"}},[n("span",{staticClass:"bubble"},[t._v(t._s(Math.trunc((new Date-(new Date).getTimezoneOffset()-Date.parse(t.getVisitor.time_of_registration))/1e3/60))+" min")]),n("span",{staticClass:"bubble"},[t._v(t._s(t.getVisitor.rating))])])]),n("div",{attrs:{id:"visitorData"}},[n("div",{staticClass:"formRow"},[n("FormElement",{staticClass:"formElement",attrs:{placeholder:"Vorname",type:"text",formData:{first_name:t.getVisitor.first_name}},on:{onFormElementKeyup:t.updateVisitor,validate:function(t){}}}),n("FormElement",{staticClass:"formElement",attrs:{placeholder:"Nachname",type:"text",formData:{last_name:t.getVisitor.last_name}},on:{onFormElementKeyup:t.updateVisitor,validate:function(t){}}})],1),n("div",{staticClass:"formRow"},[n("FormElement",{staticClass:"formElement",attrs:{placeholder:"Firma",type:"text",formData:{company:t.getVisitor.company}},on:{onFormElementKeyup:t.updateVisitor,validate:function(t){}}}),n("FormElement",{staticClass:"formElement",attrs:{placeholder:"Position",type:"text",formData:{job_title:t.getVisitor.job_title}},on:{onFormElementKeyup:t.updateVisitor,validate:function(t){}}})],1),n("div",{staticClass:"formRow"},[n("FormElement",{staticClass:"formElement",attrs:{placeholder:"E-Mail",type:"email",formData:{email:t.getVisitor.email}},on:{onFormElementKeyup:t.updateVisitor,validate:function(t){}}}),n("FormElement",{staticClass:"formElement",attrs:{placeholder:"Telefonnr.",type:"number",formData:{phone:t.getVisitor.phone}},on:{onFormElementKeyup:t.updateVisitor,validate:function(t){}}})],1),n("div",{staticClass:"formRow"},[n("FormElement",{staticClass:"formElement",attrs:{placeholder:"Produkt",type:"text",formData:{product:void 0!==t.getProducts[t.getVisitor.product_type-1]?t.getProducts[t.getVisitor.product_type-1].name:""},readonly:"readonly"},on:{onFormElementKeyup:function(t){},validate:function(t){}}}),n("FormElement",{staticClass:"formElement",attrs:{placeholder:"Social Media",type:"url",formData:{social_media_url:t.getVisitor.social_media_url}},on:{onFormElementKeyup:t.updateVisitor,validate:function(t){}}})],1)]),n("Dropdown",{staticClass:"dropdown",attrs:{id:t.getVisitor.user_hash_id,options:[{id:1,name:"none"},{id:2,name:"email"},{id:3,name:"phone"},{id:4,name:"personal conversation"}],placeholder:"none"==t.getVisitor.appointment?"Termin gewünscht":t.getVisitor.appointment},on:{selected:t.getOption}}),n("div",{attrs:{id:"pictograms"}},[n("img",{staticClass:"pictogram",attrs:{src:t.getPictograms[0]["A"+t.getVisitor.answer_one]}}),n("img",{staticClass:"pictogram",attrs:{src:t.getPictograms[1]["A"+t.getVisitor.answer_two]}}),n("img",{staticClass:"pictogram",attrs:{src:t.getPictograms[2]["A"+t.getVisitor.answer_three]}})]),n("div",{attrs:{id:"navigation"}},[n("CustomButton",{attrs:{btnName:"done"==t.getVisitor.handled_by_sales?"Ändern":"Abgearbeitet"},on:{buttonClicked:t.showModal}}),n("CustomButton",{attrs:{btnName:"Zurück"},on:{buttonClicked:t.handleReturnButton}})],1),n("v-dialog",{attrs:{id:"confirmDialog",width:300}})],1)},Q=[],X=(n("7f7f"),n("fc33")),Y=n("ae2e"),tt=n.n(Y),et={name:"DetailView",components:{FormElement:X["a"],CustomButton:F["a"],Dropdown:tt.a},data:function(){return{browserBack:!0}},methods:Object($["a"])({},Object(d["b"])(["updateVisitor","changeStatus"]),{handleCTA:function(){this.browserBack=!1,this.updateVisitor({handled_by_sales:"done"}),this.changeStatus(this.getVisitor);var t="done"===this.getVisitor.handled_by_sales?"done":this.getVisitor.rating;this.$router.push({path:"/sales/list/"+t})},handleReturnButton:function(){this.browserBack=!1;var t=this.getUnchangedVisitor;"done"!==t.handled_by_sales&&(t.handled_by_sales="not yet",this.changeStatus(t));var e="done"===this.getVisitor.handled_by_sales?"done":this.getVisitor.rating;this.$router.push({path:"/sales/list/"+e})},showModal:function(){this.$modal.show("dialog",{title:"Bestätigung",text:"Bist du dir sicher?",buttons:[{title:"Ja!",handler:this.handleCTA},{title:"Nein, zurück.",default:!0}]})},getOption:function(t){this.updateVisitor({appointment:t.name})}}),computed:Object($["a"])({},Object(d["c"])(["getVisitor","getUnchangedVisitor","getProducts","getPictograms"])),mounted:function(){document.querySelector(".dropdown-input").setAttribute("readonly","readonly")},beforeDestroy:function(){if(this.browserBack){var t=this.getUnchangedVisitor;"done"!==t.handled_by_sales&&(t.handled_by_sales="not yet",this.changeStatus(t))}}},nt=et,at=(n("c0c8"),Object(c["a"])(nt,G,Q,!1,null,"3a0a958a",null)),ot=at.exports,st=n("0086"),it=n.n(st);a["a"].config.productionTip=!1,a["a"].use(S.a,{dialog:!0}),a["a"].use(D["a"]),a["a"].use(it.a);var rt=[{path:"/sales/detail/:id",component:ot,meta:{conditionalRoute:!0}},{path:"/sales/list/:tab",component:Z,meta:{conditionalRoute:!0}},{path:"/sales/list",component:Z,meta:{conditionalRoute:!0}},{path:"/sales",component:N}],ct=new D["a"]({routes:rt,mode:"history"});ct.beforeEach(function(t,e,n){t.matched.some(function(t){return t.meta.conditionalRoute})?sessionStorage.getItem("token")?n():n({path:"/sales"}):n()}),new a["a"]({store:T,router:ct,render:function(t){return t(u)}}).$mount("#app")},c9ad:function(t,e,n){},d231:function(t,e,n){"use strict";var a=n("aadb"),o=n.n(a);o.a},d5e1:function(t,e,n){},de36:function(t,e,n){},e56b:function(t,e,n){"use strict";var a=n("c9ad"),o=n.n(a);o.a}});
//# sourceMappingURL=sales.8f0febea.js.map